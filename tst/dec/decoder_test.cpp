#include "asn1/ber/pch.h"
#ifndef  PCH
	#include <string>
    #include <vector>
#endif
#include <asn1/ber/decoder/printer.h>
#include "../tester.h"
//#define CATCH_CONFIG_MAIN
#include <catch2/catch.hpp>

namespace asn1 {
namespace ber {

namespace decoder {

using my_tester = decoder::tester<>;

const my_tester::test_item_array input_items =
{
    { // test1
        // input
        { 0x01, 0x01, 0x01 },
        { // expected
            { { tag_t::boolean }, { 1 } }
        }
    },
    { // test2
        // input
        { 0x01, 0x01, 0xff },
        { // expected
            { { tag_t::boolean }, { 0xff } }
        }
    },
    { // test3
        // input
        { 0x11, 0x08, 0x02, 0x01, 0x80, 0x09, 0x03, 0x80, 0xFB, 0x05 },
        { // expected
            { { tag_t::set }, { 0x02, 0x01, 0x80, 0x09, 0x03, 0x80, 0xFB, 0x05 } }
        }
    },
    { // test4
        // input
        { 0x30, 0x13, 0x02, 0x01, 0x05, 0x16, 0x0e, 0x41, 0x6e, 0x79, 0x62, 0x6f, 0x64, 0x79, 0x20, 0x74, 0x68, 0x65, 0x72, 0x65, 0x3f },
        { // expected
            { { tag_t::sequence }, { 0x02, 0x01, 0x05, 0x16, 0x0e, 0x41, 0x6e, 0x79, 0x62, 0x6f, 0x64, 0x79, 0x20, 0x74, 0x68, 0x65, 0x72, 0x65, 0x3f } },
            { { tag_t::integer }, { 0x05 } },
            { { tag_t::string_ia5 }, { 0x41, 0x6e, 0x79, 0x62, 0x6f, 0x64, 0x79, 0x20, 0x74, 0x68, 0x65, 0x72, 0x65, 0x3f } }
        }
    },
    { // test5
        // input
        { 0x30, 0x19, 0x93, 0x0A, 0x4A, 0x6F, 0x68, 0x6E, 0x20, 0x53, 0x6D, 0x69, 0x74, 0x68, 0x93, 0x0B, 0x39, 0x38, 0x37, 0x20, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30 },
        { // expected
            { { tag_t::sequence }, { 0x93, 0x0A, 0x4A, 0x6F, 0x68, 0x6E, 0x20, 0x53, 0x6D, 0x69, 0x74, 0x68, 0x93, 0x0B, 0x39, 0x38, 0x37, 0x20, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30 } },
            { { tag_t::string_printable }, { 0x4A, 0x6F, 0x68, 0x6E, 0x20, 0x53, 0x6D, 0x69, 0x74, 0x68 } },
            { { tag_t::string_printable }, { 0x39, 0x38, 0x37, 0x20, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30 } }
        }
    }
};

void test()
{
    my_tester t;
    t.run(input_items);
}

}}}

int main()
{
    asn1::ber::decoder::test();
}
